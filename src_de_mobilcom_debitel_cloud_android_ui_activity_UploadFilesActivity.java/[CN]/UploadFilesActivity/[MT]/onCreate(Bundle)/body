{
  Log_OC.d(TAG,"onCreate() start");
  super.onCreate(savedInstanceState);
  if (savedInstanceState != null) {
    mCurrentDir=new File(savedInstanceState.getString(UploadFilesActivity.KEY_DIRECTORY_PATH));
  }
 else {
    mCurrentDir=Environment.getExternalStorageDirectory();
  }
  mAccountOnCreation=getAccount();
  mDirectories=new CustomArrayAdapter<String>(this,R.layout.sherlock_spinner_dropdown_item);
  File currDir=mCurrentDir;
  while (currDir != null && currDir.getParentFile() != null) {
    mDirectories.add(currDir.getName());
    currDir=currDir.getParentFile();
  }
  mDirectories.add(File.separator);
  setContentView(R.layout.upload_files_layout);
  mFileListFragment=(LocalFileListFragment)getSupportFragmentManager().findFragmentById(R.id.local_files_list);
  mCancelBtn=(Button)findViewById(R.id.upload_files_btn_cancel);
  mCancelBtn.setOnClickListener(this);
  mUploadBtn=(Button)findViewById(R.id.upload_files_btn_upload);
  mUploadBtn.setOnClickListener(this);
  boolean customButtons=getResources().getBoolean(R.bool.custom_buttons);
  if (customButtons) {
    mCancelBtn.setBackgroundResource(R.drawable.btn_default);
    mUploadBtn.setBackgroundResource(R.drawable.btn_default);
  }
  ActionBar actionBar=getSupportActionBar();
  actionBar.setHomeButtonEnabled(true);
  actionBar.setDisplayHomeAsUpEnabled(mCurrentDir != null && mCurrentDir.getName() != null);
  actionBar.setDisplayShowTitleEnabled(false);
  actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);
  actionBar.setListNavigationCallbacks(mDirectories,this);
  if (mCurrentDialog != null) {
    mCurrentDialog.dismiss();
    mCurrentDialog=null;
  }
  Log_OC.d(TAG,"onCreate() end");
}

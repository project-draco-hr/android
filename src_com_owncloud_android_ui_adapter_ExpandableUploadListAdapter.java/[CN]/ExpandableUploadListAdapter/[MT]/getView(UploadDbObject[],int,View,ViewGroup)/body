{
  View view=convertView;
  if (view == null) {
    LayoutInflater inflator=(LayoutInflater)mActivity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    view=inflator.inflate(R.layout.upload_list_item,null);
  }
  if (uploadsItems != null && uploadsItems.length > position) {
    final UploadDbObject uploadObject=uploadsItems[position];
    TextView fileName=(TextView)view.findViewById(R.id.upload_name);
    String file=uploadObject.getOCFile().getFileName();
    fileName.setText(file);
    TextView localPath=(TextView)view.findViewById(R.id.upload_local_path);
    String path=uploadObject.getOCFile().getStoragePath();
    path=path.substring(0,path.length() - file.length() - 1);
    localPath.setText("Path: " + path);
    TextView fileSize=(TextView)view.findViewById(R.id.upload_file_size);
    fileSize.setText(DisplayUtils.bytesToHumanReadable(uploadObject.getOCFile().getFileLength()));
    TextView statusView=(TextView)view.findViewById(R.id.upload_status);
    String status;
switch (uploadObject.getUploadStatus()) {
case UPLOAD_IN_PROGRESS:
      status=mActivity.getResources().getString(R.string.uploader_upload_in_progress_ticker);
    break;
case UPLOAD_FAILED_GIVE_UP:
  if (uploadObject.getLastResult() != null) {
    status="Upload failed: " + uploadObject.getLastResult().getLogMessage();
  }
 else {
    status="Upload failed.";
  }
break;
case UPLOAD_FAILED_RETRY:
if (uploadObject.getLastResult() != null) {
status="Last failure: " + uploadObject.getLastResult().getLogMessage();
}
 else {
status="Upload will be retried shortly.";
}
String laterReason=FileUploadService.getUploadLaterReason(mActivity,uploadObject);
if (laterReason != null) {
status+="\n" + laterReason;
}
break;
case UPLOAD_LATER:
status=FileUploadService.getUploadLaterReason(mActivity,uploadObject);
break;
case UPLOAD_SUCCEEDED:
status="Completed.";
break;
case UPLOAD_CANCELLED:
status="Upload cancelled.";
break;
case UPLOAD_PAUSED:
status="Upload paused.";
break;
default :
status=uploadObject.getUploadStatus().toString();
if (uploadObject.getLastResult() != null) {
uploadObject.getLastResult().getLogMessage();
}
break;
}
statusView.setText(status);
Button rightButton=(Button)view.findViewById(R.id.upload_right_button);
if (UploadUtils.userCanRetryUpload(uploadObject) && uploadObject.getUploadStatus() != UploadStatus.UPLOAD_SUCCEEDED) {
rightButton.setText("\u21BA");
rightButton.setOnClickListener(new OnClickListener(){
@Override public void onClick(View v){
parentFileActivity.getFileOperationsHelper().retryUpload(uploadObject);
}
}
);
}
 else if (UploadUtils.userCanCancelUpload(uploadObject)) {
rightButton.setText("\u274C");
rightButton.setOnClickListener(new OnClickListener(){
@Override public void onClick(View v){
parentFileActivity.getFileOperationsHelper().cancelTransference(uploadObject.getOCFile());
}
}
);
}
 else {
rightButton.setText("\u267B");
rightButton.setOnClickListener(new OnClickListener(){
@Override public void onClick(View v){
parentFileActivity.getFileOperationsHelper().removeUploadFromList(uploadObject);
}
}
);
}
ImageView fileIcon=(ImageView)view.findViewById(R.id.imageView1);
fileIcon.setImageResource(R.drawable.file);
try {
Bitmap b=ThumbnailsCacheManager.getBitmapFromDiskCache(uploadObject.getOCFile().getRemoteId());
if (b != null) {
fileIcon.setImageBitmap(b);
}
}
 catch (NullPointerException e) {
}
TextView uploadDate=(TextView)view.findViewById(R.id.upload_date);
CharSequence dateString=DisplayUtils.getRelativeDateTimeString(mActivity,uploadObject.getUploadTime().getTimeInMillis(),DateUtils.SECOND_IN_MILLIS,DateUtils.WEEK_IN_MILLIS,0);
uploadDate.setText(dateString);
}
return view;
}

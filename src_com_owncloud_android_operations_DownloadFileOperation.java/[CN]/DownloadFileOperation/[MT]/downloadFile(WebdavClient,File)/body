{
  int status=-1;
  boolean savedFile=false;
  GetMethod get=new GetMethod(client.getBaseUri() + WebdavUtils.encodePath(mFile.getRemotePath()));
  Iterator<OnDatatransferProgressListener> it=null;
  FileOutputStream fos=null;
  try {
    status=client.executeMethod(get);
    if (isSuccess(status)) {
      targetFile.createNewFile();
      BufferedInputStream bis=new BufferedInputStream(get.getResponseBodyAsStream());
      fos=new FileOutputStream(targetFile);
      long transferred=0;
      byte[] bytes=new byte[4096];
      int readResult=0;
      while ((readResult=bis.read(bytes)) != -1) {
synchronized (mCancellationRequested) {
          if (mCancellationRequested.get()) {
            get.abort();
            throw new OperationCancelledException();
          }
        }
        fos.write(bytes,0,readResult);
        transferred+=readResult;
        it=mDataTransferListeners.iterator();
        while (it.hasNext()) {
          it.next().onTransferProgress(readResult,transferred,mFile.getFileLength(),targetFile.getName());
        }
      }
      savedFile=true;
    }
 else {
      client.exhaustResponse(get.getResponseBodyAsStream());
    }
  }
  finally {
    if (fos != null)     fos.close();
    if (!savedFile && targetFile.exists()) {
      targetFile.delete();
    }
    get.releaseConnection();
  }
  return status;
}

{
  Log_OC.d(TAG,"New file " + fileName);
  final String mimeType=MimetypeIconUtil.getBestMimeTypeByFilename(fileName);
  final boolean isImage=mimeType.startsWith("image/");
  final boolean isVideo=mimeType.startsWith("video/");
  if (!isImage && !isVideo) {
    Log_OC.d(TAG,"Ignoring " + fileName);
  }
  if (isImage && !mConfiguration.isEnabledForPictures()) {
    Log_OC.d(TAG,"Instant upload disabled for images, ignoring " + fileName);
    return;
  }
  if (isVideo && !mConfiguration.isEnabledForVideos()) {
    Log_OC.d(TAG,"Instant upload disabled for videos, ignoring " + fileName);
    return;
  }
  int permissionCheck=ContextCompat.checkSelfPermission(mContext,Manifest.permission.READ_EXTERNAL_STORAGE);
  if (android.content.pm.PackageManager.PERMISSION_GRANTED != permissionCheck) {
    Log_OC.w(TAG,"Read external storage permission isn't granted, aborting");
    return;
  }
  mDelayerExecutor.schedule(new Runnable(){
    @Override public void run(){
      String localPath=mConfiguration.getSourcePath() + File.separator + fileName;
      File localFile=new File(localPath);
      if (!localFile.exists() || localFile.length() <= 0) {
        Log_OC.w(TAG,"Camera app saved an empty or temporary file, ignoring " + fileName);
        return;
      }
      Account account=AccountUtils.getOwnCloudAccountByName(mContext,mConfiguration.getUploadAccountName());
      if (account == null) {
        Log_OC.w(TAG,"No account found for instant upload, aborting upload");
        return;
      }
      String remotePath=(isImage ? mConfiguration.getUploadPathForPictures() : mConfiguration.getUploadPathForVideos()) + File.separator + fileName;
      int createdBy=isImage ? UploadFileOperation.CREATED_AS_INSTANT_PICTURE : UploadFileOperation.CREATED_AS_INSTANT_VIDEO;
      FileUploader.UploadRequester requester=new FileUploader.UploadRequester();
      requester.uploadNewFile(mContext,account,localPath,remotePath,mConfiguration.getBehaviourAfterUpload(),mimeType,true,createdBy);
      Log_OC.i(TAG,String.format("Requested upload of %1s to %2s in %3s",localPath,remotePath,account.name));
    }
  }
,200,TimeUnit.MILLISECONDS);
}

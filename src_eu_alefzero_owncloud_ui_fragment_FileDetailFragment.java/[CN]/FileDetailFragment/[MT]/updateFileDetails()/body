{
  mFile=mIntent.getParcelableExtra(EXTRA_FILE);
  Button downloadButton=(Button)getView().findViewById(R.id.fdDownloadBtn);
  if (mFile != null) {
    setFilename(mFile.getFileName());
    setFiletype(DisplayUtils.convertMIMEtoPrettyPrint(mFile.getMimetype()));
    setFilesize(mFile.getFileLength());
    if (ocVersionSupportsTimeCreated()) {
      setTimeCreated(mFile.getCreationTimestamp());
    }
    setTimeModified(mFile.getModificationTimestamp());
    if (mFile.getStoragePath() != null) {
      ImageView preview=(ImageView)getView().findViewById(R.id.fdPreview);
      try {
        if (mFile.getMimetype().startsWith("image/")) {
          BitmapFactory.Options options=new Options();
          options.inScaled=true;
          options.inMutable=false;
          options.inPreferQualityOverSpeed=false;
          options.inPurgeable=true;
          Bitmap bmp=BitmapFactory.decodeFile(mFile.getStoragePath(),options);
          int width=options.outWidth;
          int height=options.outHeight;
          int scale=1;
          if (width >= 2048 || height >= 2048) {
            scale=(int)(Math.ceil(Math.max(height,width) / 2048.));
            options.inSampleSize=scale;
            bmp.recycle();
            bmp=BitmapFactory.decodeFile(mFile.getStoragePath(),options);
          }
          preview.setImageBitmap(bmp);
        }
      }
 catch (      OutOfMemoryError e) {
        preview.setVisibility(View.INVISIBLE);
        Log.e(TAG,"Out of memory occured for file with size " + mFile.getFileLength());
      }
      downloadButton.setText(R.string.filedetails_open);
      downloadButton.setOnClickListener(new OnClickListener(){
        @Override public void onClick(        View v){
          Intent i=new Intent(Intent.ACTION_VIEW);
          i.setDataAndType(Uri.parse("file://" + mFile.getStoragePath()),mFile.getMimetype());
          List list=getActivity().getPackageManager().queryIntentActivities(i,PackageManager.MATCH_DEFAULT_ONLY);
          if (list.size() > 0) {
            startActivity(i);
          }
 else {
            Toast.makeText(getActivity(),"There is no application to handle file " + mFile.getFileName(),Toast.LENGTH_SHORT).show();
          }
        }
      }
);
    }
 else {
      downloadButton.setOnClickListener(this);
    }
  }
}

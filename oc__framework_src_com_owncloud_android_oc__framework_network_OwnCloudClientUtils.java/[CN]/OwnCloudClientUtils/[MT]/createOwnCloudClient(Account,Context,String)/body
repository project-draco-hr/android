{
  Uri uri=Uri.parse(AccountUtils.constructFullURLForAccount(appContext,account));
  AccountManager am=AccountManager.get(appContext);
  boolean isOauth2=am.getUserData(account,AccountAuthenticatorConstants.KEY_SUPPORTS_OAUTH2) != null;
  boolean isSamlSso=am.getUserData(account,AccountAuthenticatorConstants.KEY_SUPPORTS_SAML_WEB_SSO) != null;
  WebdavClient client=createOwnCloudClient(uri,appContext,!isSamlSso,authorities);
  if (isOauth2) {
    String accessToken=am.blockingGetAuthToken(account,AccountTypeUtils.getAuthTokenTypeAccessToken(account),false);
    client.setBearerCredentials(accessToken,authorities);
  }
 else   if (isSamlSso) {
    String accessToken=am.blockingGetAuthToken(account,AccountTypeUtils.getAuthTokenTypeSamlSessionCookie(account),false);
    client.setSsoSessionCookie(accessToken,authorities);
  }
 else {
    String username=account.name.substring(0,account.name.lastIndexOf('@'));
    String password=am.blockingGetAuthToken(account,AccountTypeUtils.getAuthTokenTypePass(account),false);
    client.setBasicCredentials(username,password,authorities);
  }
  return client;
}

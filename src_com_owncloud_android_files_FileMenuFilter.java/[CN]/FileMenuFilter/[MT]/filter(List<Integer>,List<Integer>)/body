{
  boolean synchronizing=false;
  if (mComponentsGetter != null && mFile != null && mAccount != null) {
    OperationsServiceBinder opsBinder=mComponentsGetter.getOperationsServiceBinder();
    FileUploaderBinder uploaderBinder=mComponentsGetter.getFileUploaderBinder();
    FileDownloaderBinder downloaderBinder=mComponentsGetter.getFileDownloaderBinder();
    synchronizing=((opsBinder != null && opsBinder.isSynchronizing(mAccount,mFile.getRemotePath())) || (downloaderBinder != null && downloaderBinder.isDownloading(mAccount,mFile)) || (uploaderBinder != null && uploaderBinder.isUploading(mAccount,mFile)));
  }
  if (mFile == null || mFile.isDown() || mFile.isFolder() || synchronizing) {
    toHide.add(R.id.action_download_file);
  }
 else {
    toShow.add(R.id.action_download_file);
  }
  if (mFile == null || synchronizing) {
    toHide.add(R.id.action_rename_file);
  }
 else {
    toShow.add(R.id.action_rename_file);
  }
  if (mFile == null || synchronizing) {
    toHide.add(R.id.action_move);
    toHide.add(R.id.action_copy);
  }
 else {
    toShow.add(R.id.action_move);
    toShow.add(R.id.action_copy);
  }
  if (mFile == null || synchronizing) {
    toHide.add(R.id.action_remove_file);
  }
 else {
    toShow.add(R.id.action_remove_file);
  }
  if (mFile == null || mFile.isFolder() || !mFile.isDown() || synchronizing) {
    toHide.add(R.id.action_open_file_with);
  }
 else {
    toShow.add(R.id.action_open_file_with);
  }
  if (mFile == null || !synchronizing) {
    toHide.add(R.id.action_cancel_sync);
  }
 else {
    toShow.add(R.id.action_cancel_sync);
  }
  if (mFile == null || (!mFile.isFolder() && !mFile.isDown()) || synchronizing) {
    toHide.add(R.id.action_sync_file);
  }
 else {
    toShow.add(R.id.action_sync_file);
  }
  boolean shareByLinkAllowed=(mContext != null && mContext.getString(R.string.show_share_by_link_section).equalsIgnoreCase("true"));
  boolean shareWithUsersAllowed=(mContext != null && mContext.getString(R.string.show_share_with_users_section).equalsIgnoreCase("true"));
  OCCapability capability=mComponentsGetter.getStorageManager().getCapability(mAccount.name);
  boolean shareApiEnabled=capability != null && (capability.getFilesSharingApiEnabled().isTrue() || capability.getFilesSharingApiEnabled().isUnknown());
  if ((!shareByLinkAllowed && !shareWithUsersAllowed) || mFile == null || !shareApiEnabled) {
    toHide.add(R.id.action_share_file);
  }
 else {
    toShow.add(R.id.action_share_file);
  }
  if (mFile == null || mFile.isFolder()) {
    toHide.add(R.id.action_see_details);
  }
 else {
    toShow.add(R.id.action_see_details);
  }
  boolean sendAllowed=(mContext != null && mContext.getString(R.string.send_files_to_other_apps).equalsIgnoreCase("on"));
  if (mFile == null || !sendAllowed || mFile.isFolder() || synchronizing) {
    toHide.add(R.id.action_send_file);
  }
 else {
    toShow.add(R.id.action_send_file);
  }
  if (mFile == null || synchronizing || mFile.isFolder() || mFile.isFavorite()) {
    toHide.add(R.id.action_favorite_file);
  }
 else {
    toShow.add(R.id.action_favorite_file);
  }
  if (mFile == null || synchronizing || mFile.isFolder() || !mFile.isFavorite()) {
    toHide.add(R.id.action_unfavorite_file);
  }
 else {
    toShow.add(R.id.action_unfavorite_file);
  }
}

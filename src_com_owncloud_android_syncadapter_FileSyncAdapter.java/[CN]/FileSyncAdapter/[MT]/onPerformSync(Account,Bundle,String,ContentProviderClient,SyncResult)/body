{
  mCancellation=false;
  mIsManualSync=extras.getBoolean(ContentResolver.SYNC_EXTRAS_MANUAL,false);
  mFailedResultsCounter=0;
  mLastFailedResult=null;
  this.setAccount(account);
  this.setContentProvider(provider);
  this.setStorageManager(new FileDataStorageManager(account,getContentProvider()));
  Log.d(TAG,"syncing owncloud account " + account.name);
  sendStickyBroadcast(true,null,null);
  try {
    updateOCVersion();
    mCurrentSyncTime=System.currentTimeMillis();
    if (!mCancellation) {
      fetchData(OCFile.PATH_SEPARATOR,syncResult,DataStorageManager.ROOT_PARENT_ID);
    }
 else {
      Log.d(TAG,"Leaving synchronization before any remote request due to cancellation was requested");
    }
  }
  finally {
    if (mFailedResultsCounter > 0 && mIsManualSync) {
      syncResult.tooManyRetries=true;
      notifyFailedSynchronization();
    }
    sendStickyBroadcast(false,null,mLastFailedResult);
  }
}

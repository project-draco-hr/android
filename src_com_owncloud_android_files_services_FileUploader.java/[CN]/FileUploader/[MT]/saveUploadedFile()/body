{
  OCFile file=mCurrentUpload.getFile();
  PropFindMethod propfind=null;
  RemoteOperationResult result=null;
  long syncDate=System.currentTimeMillis();
  try {
    propfind=new PropFindMethod(mUploadClient.getBaseUri() + WebdavUtils.encodePath(mCurrentUpload.getRemotePath()));
    int status=mUploadClient.executeMethod(propfind);
    boolean isMultiStatus=(status == HttpStatus.SC_MULTI_STATUS);
    if (isMultiStatus) {
      MultiStatus resp=propfind.getResponseBodyAsMultiStatus();
      WebdavEntry we=new WebdavEntry(resp.getResponses()[0],mUploadClient.getBaseUri().getPath());
      OCFile newFile=fillOCFile(we);
      newFile.setStoragePath(file.getStoragePath());
      newFile.setKeepInSync(file.keepInSync());
      newFile.setLastSyncDateForProperties(syncDate);
      file=newFile;
    }
 else {
      mUploadClient.exhaustResponse(propfind.getResponseBodyAsStream());
    }
    result=new RemoteOperationResult(isMultiStatus,status);
    Log.i(TAG,"Update: synchronizing properties for uploaded " + mCurrentUpload.getRemotePath() + ": "+ result.getLogMessage());
  }
 catch (  Exception e) {
    result=new RemoteOperationResult(e);
    Log.i(TAG,"Update: synchronizing properties for uploaded " + mCurrentUpload.getRemotePath() + ": "+ result.getLogMessage(),e);
  }
 finally {
    if (propfind != null)     propfind.releaseConnection();
  }
  file.setLastSyncDateForData(syncDate);
  if (!result.isSuccess() && !mCurrentUpload.getRemotePath().equals(file.getRemotePath())) {
    OCFile newFile=new OCFile(mCurrentUpload.getRemotePath());
    newFile.setCreationTimestamp(file.getCreationTimestamp());
    newFile.setFileLength(file.getFileLength());
    newFile.setMimetype(file.getMimetype());
    newFile.setModificationTimestamp(file.getModificationTimestamp());
    newFile.setLastSyncDateForProperties(file.getLastSyncDateForProperties());
    newFile.setStoragePath(file.getStoragePath());
    newFile.setKeepInSync(file.keepInSync());
    file=newFile;
  }
  mStorageManager.saveFile(file);
}

{
synchronized (mPendingUploads) {
    mCurrentUpload=mPendingUploads.get(uploadKey);
  }
  if (mCurrentUpload != null) {
    notifyUploadStart(mCurrentUpload);
    RemoteOperationResult uploadResult=null, grantResult=null;
    try {
      if (mUploadClient == null || !mLastAccount.equals(mCurrentUpload.getAccount())) {
        mLastAccount=mCurrentUpload.getAccount();
        mStorageManager=new FileDataStorageManager(mLastAccount,getContentResolver());
        mUploadClient=OwnCloudClientUtils.createOwnCloudClient(mLastAccount,getApplicationContext());
      }
      String remoteParentPath=new File(mCurrentUpload.getRemotePath()).getParent();
      remoteParentPath=remoteParentPath.endsWith(OCFile.PATH_SEPARATOR) ? remoteParentPath : remoteParentPath + OCFile.PATH_SEPARATOR;
      grantResult=grantFolderExistence(remoteParentPath);
      if (grantResult.isSuccess()) {
        OCFile parent=mStorageManager.getFileByPath(remoteParentPath);
        mCurrentUpload.getFile().setParentId(parent.getFileId());
        uploadResult=mCurrentUpload.execute(mUploadClient);
        if (uploadResult.isSuccess()) {
          saveUploadedFile();
        }
      }
 else {
        uploadResult=grantResult;
      }
    }
 catch (    AccountsException e) {
      Log_OC.e(TAG,"Error while trying to get autorization for " + mLastAccount.name,e);
      uploadResult=new RemoteOperationResult(e);
    }
catch (    IOException e) {
      Log_OC.e(TAG,"Error while trying to get autorization for " + mLastAccount.name,e);
      uploadResult=new RemoteOperationResult(e);
    }
 finally {
synchronized (mPendingUploads) {
        mPendingUploads.remove(uploadKey);
        Log_OC.i(TAG,"Remove CurrentUploadItem from pending upload Item Map.");
      }
    }
    notifyUploadResult(uploadResult,mCurrentUpload);
    sendFinalBroadcast(mCurrentUpload,uploadResult);
  }
}

{
  DataStorageManager storageManager=((FileDisplayActivity)getActivity()).getStorageManager();
  if (directory == null) {
    if (mFile != null) {
      directory=mFile;
    }
 else {
      directory=storageManager.getFileByPath("/");
      if (directory == null)       return;
    }
  }
  if (!directory.isDirectory()) {
    Log.w(TAG,"You see, that is not a directory -> " + directory.toString());
    directory=storageManager.getFileById(directory.getParentId());
  }
  mFile=directory;
  mFiles=storageManager.getDirectoryContent(directory);
  if (mFiles == null || mFiles.size() == 0) {
    Toast.makeText(getActivity(),"There are no files here",Toast.LENGTH_LONG).show();
  }
  setListAdapter(new FileListListAdapter(directory,storageManager,getActivity()));
}

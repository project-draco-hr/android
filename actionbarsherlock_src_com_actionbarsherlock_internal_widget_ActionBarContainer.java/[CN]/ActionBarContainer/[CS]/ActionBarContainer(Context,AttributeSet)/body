{
  super(context,attrs);
  setBackgroundDrawable(null);
  TypedArray a=context.obtainStyledAttributes(attrs,R.styleable.SherlockActionBar);
  mBackground=a.getDrawable(R.styleable.SherlockActionBar_background);
  mStackedBackground=a.getDrawable(R.styleable.SherlockActionBar_backgroundStacked);
  if (mStackedBackground instanceof ColorDrawable && Build.VERSION.SDK_INT < Build.VERSION_CODES.HONEYCOMB) {
    Bitmap bitmap=Bitmap.createBitmap(1,1,Bitmap.Config.ARGB_8888);
    Canvas c=new Canvas(bitmap);
    mStackedBackground.draw(c);
    int color=bitmap.getPixel(0,0);
    bitmap.recycle();
    mStackedBackground=new IcsColorDrawable(color);
  }
  if (getId() == R.id.abs__split_action_bar) {
    mIsSplit=true;
    mSplitBackground=a.getDrawable(R.styleable.SherlockActionBar_backgroundSplit);
  }
  a.recycle();
  setWillNotDraw(mIsSplit ? mSplitBackground == null : mBackground == null && mStackedBackground == null);
}

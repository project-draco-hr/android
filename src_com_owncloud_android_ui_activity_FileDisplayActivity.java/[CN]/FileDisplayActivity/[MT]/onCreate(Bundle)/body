{
  Log_OC.d(TAG,"onCreate() start");
  super.onCreate(savedInstanceState);
  mStarted=false;
  mHandler=new Handler();
  if (savedInstanceState != null) {
    mWaitingToPreview=(OCFile)savedInstanceState.getParcelable(FileDetailActivity.KEY_WAITING_TO_PREVIEW);
  }
 else {
    mWaitingToPreview=null;
  }
  mUploadConnection=new ListServiceConnection();
  mDownloadConnection=new ListServiceConnection();
  bindService(new Intent(this,FileUploader.class),mUploadConnection,Context.BIND_AUTO_CREATE);
  bindService(new Intent(this,FileDownloader.class),mDownloadConnection,Context.BIND_AUTO_CREATE);
  if (getIntent().getAction() != null && getIntent().getAction().equals(Intent.ACTION_MAIN) && savedInstanceState == null) {
    requestPinCode();
  }
  Intent observer_intent=new Intent(this,FileObserverService.class);
  observer_intent.putExtra(FileObserverService.KEY_FILE_CMD,FileObserverService.CMD_INIT_OBSERVED_LIST);
  startService(observer_intent);
  requestWindowFeature(Window.FEATURE_INDETERMINATE_PROGRESS);
  mDirectories=new CustomArrayAdapter<String>(this,R.layout.sherlock_spinner_dropdown_item);
  OCFile currFile=getFile();
  while (mStorageManager != null && currFile != null && currFile.getFileName() != OCFile.PATH_SEPARATOR) {
    mDirectories.add(currFile.getFileName());
    currFile=mStorageManager.getFileById(currFile.getParentId());
  }
  mDirectories.add(OCFile.PATH_SEPARATOR);
  setContentView(R.layout.files);
  mFileList=(OCFileListFragment)getSupportFragmentManager().findFragmentById(R.id.fileList);
  mDualPane=(findViewById(R.id.file_details_container) != null);
  if (mDualPane && savedInstanceState == null) {
    initFileDetailsInDualPane();
  }
  ActionBar actionBar=getSupportActionBar();
  actionBar.setHomeButtonEnabled(true);
  actionBar.setDisplayHomeAsUpEnabled(getFile() != null && getFile().getParentId() != 0);
  actionBar.setDisplayShowTitleEnabled(false);
  actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);
  actionBar.setListNavigationCallbacks(mDirectories,this);
  setSupportProgressBarIndeterminateVisibility(false);
  mBackFromCreatingFirstAccount=false;
  Log_OC.d(TAG,"onCreate() end");
}

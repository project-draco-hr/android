{
  if (!isDrawerOpen()) {
    OCFileListFragment listOfFiles=getListOfFilesFragment();
    if (mDualPane || getSecondFragment() == null) {
      OCFile currentDir=getCurrentDir();
      if (currentDir == null || currentDir.getParentId() == FileDataStorageManager.ROOT_PARENT_ID) {
        finish();
        return;
      }
      if (listOfFiles != null) {
        listOfFiles.onBrowseUp();
      }
    }
    if (listOfFiles != null) {
      setFile(listOfFiles.getCurrentFile());
    }
    cleanSecondFragment();
  }
 else {
    super.onBackPressed();
  }
  MenuItem menuItem=mOptionsMenu.findItem(R.id.action_switch_view);
  if (DisplayUtils.isGridView(getFile(),getStorageManager())) {
    menuItem.setTitle(getApplicationContext().getString(R.string.action_switch_list_view));
  }
 else {
    menuItem.setTitle(getApplicationContext().getString(R.string.action_switch_grid_view));
  }
}

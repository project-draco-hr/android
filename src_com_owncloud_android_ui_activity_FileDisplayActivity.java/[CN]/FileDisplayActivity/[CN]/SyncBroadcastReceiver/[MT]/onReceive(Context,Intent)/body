{
  boolean inProgress=intent.getBooleanExtra(FileSyncService.IN_PROGRESS,false);
  String accountName=intent.getStringExtra(FileSyncService.ACCOUNT_NAME);
  RemoteOperationResult synchResult=(RemoteOperationResult)intent.getSerializableExtra(FileSyncService.SYNC_RESULT);
  if (getAccount() != null && accountName.equals(getAccount().name) && mStorageManager != null) {
    if (isSharedSupported()) {
      startGetSharedFiles();
    }
    String synchFolderRemotePath=intent.getStringExtra(FileSyncService.SYNC_FOLDER_REMOTE_PATH);
    OCFile currentFile=(getFile() == null) ? null : mStorageManager.getFileByPath(getFile().getRemotePath());
    OCFile currentDir=(getCurrentDir() == null) ? null : mStorageManager.getFileByPath(getCurrentDir().getRemotePath());
    if (currentDir == null) {
      Toast.makeText(FileDisplayActivity.this,String.format(getString(R.string.sync_current_folder_was_removed),mDirectories.getItem(0)),Toast.LENGTH_LONG).show();
      browseToRoot();
    }
 else {
      if (currentFile == null && !getFile().isFolder()) {
        cleanSecondFragment();
        currentFile=currentDir;
      }
      if (synchFolderRemotePath != null && currentDir.getRemotePath().equals(synchFolderRemotePath)) {
        OCFileListFragment fileListFragment=getListOfFilesFragment();
        if (fileListFragment != null) {
          fileListFragment.listDirectory(currentDir);
        }
      }
      setFile(currentFile);
    }
    if (!mRefreshSharesInProgress) {
      setSupportProgressBarIndeterminateVisibility(inProgress);
    }
 else {
      setSupportProgressBarIndeterminateVisibility(true);
    }
    removeStickyBroadcast(intent);
    mSyncInProgress=inProgress;
  }
  if (synchResult != null) {
    if (synchResult.getCode().equals(RemoteOperationResult.ResultCode.SSL_RECOVERABLE_PEER_UNVERIFIED)) {
      mLastSslUntrustedServerResult=synchResult;
      showDialog(DIALOG_SSL_VALIDATOR);
    }
  }
}

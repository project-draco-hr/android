{
  String event=intent.getAction();
  String accountName=intent.getStringExtra(FileSyncAdapter.EXTRA_ACCOUNT_NAME);
  String synchFolderRemotePath=intent.getStringExtra(FileSyncAdapter.EXTRA_FOLDER_PATH);
  RemoteOperationResult synchResult=(RemoteOperationResult)intent.getSerializableExtra(FileSyncAdapter.EXTRA_RESULT);
  boolean sameAccount=(getAccount() != null && accountName.equals(getAccount().name) && mStorageManager != null);
  if (sameAccount) {
    if (!FileSyncAdapter.EVENT_FULL_SYNC_START.equals(event)) {
      OCFile currentFile=(getFile() == null) ? null : mStorageManager.getFileByPath(getFile().getRemotePath());
      OCFile currentDir=(getCurrentDir() == null) ? null : mStorageManager.getFileByPath(getCurrentDir().getRemotePath());
      if (currentDir == null) {
        Toast.makeText(FileDisplayActivity.this,String.format(getString(R.string.sync_current_folder_was_removed),mDirectories.getItem(0)),Toast.LENGTH_LONG).show();
        browseToRoot();
      }
 else {
        if (currentFile == null && !getFile().isFolder()) {
          cleanSecondFragment();
          currentFile=currentDir;
        }
        if (synchFolderRemotePath != null && currentDir.getRemotePath().equals(synchFolderRemotePath)) {
          OCFileListFragment fileListFragment=getListOfFilesFragment();
          if (fileListFragment != null) {
            fileListFragment.listDirectory(currentDir);
          }
        }
        setFile(currentFile);
      }
      mSyncInProgress=(!FileSyncAdapter.EVENT_FULL_SYNC_END.equals(event) && !SynchronizeFolderOperation.EVENT_SINGLE_FOLDER_SYNCED.equals(event) && (synchResult == null || synchResult.isSuccess()));
      if (synchResult != null && synchResult.isSuccess() && (SynchronizeFolderOperation.EVENT_SINGLE_FOLDER_SYNCED.equals(event) || FileSyncAdapter.EVENT_FOLDER_CONTENTS_SYNCED.equals(event))) {
        startGetShares();
      }
    }
    setSupportProgressBarIndeterminateVisibility(mSyncInProgress || mRefreshSharesInProgress);
  }
  if (synchResult != null) {
    if (synchResult.getCode().equals(RemoteOperationResult.ResultCode.SSL_RECOVERABLE_PEER_UNVERIFIED)) {
      mLastSslUntrustedServerResult=synchResult;
      showDialog(DIALOG_SSL_VALIDATOR);
    }
  }
}

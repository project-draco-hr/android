{
  if (mStorageManager == null) {
    throw new IllegalStateException("Do not call this method before initializing mStorageManager");
  }
  SharedPreferences appPreferences=PreferenceManager.getDefaultSharedPreferences(getApplicationContext());
  String last_path=appPreferences.getString("last_upload_path","");
  if (last_path.equals("/")) {
    mParents.add("");
  }
 else {
    String[] dir_names=last_path.split("/");
    for (    String dir : dir_names)     mParents.add(dir);
  }
  if (mParents.size() > 1) {
    while (!mStorageManager.fileExists(generatePath(mParents))) {
      mParents.pop();
    }
  }
}

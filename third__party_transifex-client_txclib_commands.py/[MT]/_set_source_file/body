def _set_source_file(path_to_tx, resource, lang, path_to_file):
    'Reusable method to set source file.'
    (proj, res) = resource.split('.')
    if ((not proj) or (not res)):
        raise Exception(('"%s.%s" is not a valid resource identifier. It should be in the following format project_slug.resource_slug.' % (proj, res)))
    if (not lang):
        raise Exception("You haven't specified a source language.")
    try:
        _go_to_dir(path_to_tx)
    except UnInitializedError as e:
        utils.logger.error(e)
        return
    if (not os.path.exists(path_to_file)):
        raise Exception(('tx: File ( %s ) does not exist.' % os.path.join(path_to_tx, path_to_file)))
    prj = project.Project(path_to_tx)
    root_dir = os.path.abspath(path_to_tx)
    if (root_dir not in os.path.normpath(os.path.abspath(path_to_file))):
        raise Exception('File must be under the project root directory.')
    logger.info(('Setting source file for resource %s.%s ( %s -> %s ).' % (proj, res, lang, path_to_file)))
    path_to_file = relpath(path_to_file, root_dir)
    prj = project.Project(path_to_tx)
    try:
        try:
            prj.config.get(('%s.%s' % (proj, res)), 'source_file')
        except ConfigParser.NoSectionError:
            prj.config.add_section(('%s.%s' % (proj, res)))
        except ConfigParser.NoOptionError:
            pass
    finally:
        prj.config.set(('%s.%s' % (proj, res)), 'source_file', path_to_file)
        prj.config.set(('%s.%s' % (proj, res)), 'source_lang', lang)
    prj.save()

{
  if (file != null) {
    String storagePath=file.getStoragePath();
    String encodedStoragePath=WebdavUtils.encodePath(storagePath);
    Intent intentForSavedMimeType=new Intent(Intent.ACTION_VIEW);
    intentForSavedMimeType.setDataAndType(Uri.parse("file://" + encodedStoragePath),file.getMimetype());
    intentForSavedMimeType.setFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION | Intent.FLAG_GRANT_WRITE_URI_PERMISSION);
    Intent intentForGuessedMimeType=null;
    if (storagePath.lastIndexOf('.') >= 0) {
      String guessedMimeType=MimeTypeMap.getSingleton().getMimeTypeFromExtension(storagePath.substring(storagePath.lastIndexOf('.') + 1));
      if (guessedMimeType != null && !guessedMimeType.equals(file.getMimetype())) {
        intentForGuessedMimeType=new Intent(Intent.ACTION_VIEW);
        intentForGuessedMimeType.setDataAndType(Uri.parse("file://" + encodedStoragePath),guessedMimeType);
        intentForGuessedMimeType.setFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION | Intent.FLAG_GRANT_WRITE_URI_PERMISSION);
      }
    }
    Intent chooserIntent=null;
    if (intentForGuessedMimeType != null) {
      chooserIntent=Intent.createChooser(intentForGuessedMimeType,getString(R.string.actionbar_open_with));
    }
 else {
      chooserIntent=Intent.createChooser(intentForSavedMimeType,getString(R.string.actionbar_open_with));
    }
    startActivity(chooserIntent);
  }
 else {
    Log_OC.wtf(TAG,"Trying to open a NULL OCFile");
  }
}

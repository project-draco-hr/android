{
  if (isCancelled()) {
    bitmap=null;
  }
  if (imageViewReference != null && bitmap != null) {
    final ImageView imageView=imageViewReference.get();
    final ThumbnailGenerationTask bitmapWorkerTask=getBitmapWorkerTask(imageView);
    if (this == bitmapWorkerTask && imageView != null) {
      if (imageView.getTag().equals(file.getFileId())) {
        imageView.setImageBitmap(bitmap);
      }
    }
  }
}

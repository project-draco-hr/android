{
  RemoteOperationResult result=null;
  OCShare share=getStorageManager().getFirstShareByPathAndType(mRemotePath,mShareType,mShareWith);
  if (share != null) {
    RemoveRemoteShareOperation operation=new RemoveRemoteShareOperation((int)share.getIdRemoteShared());
    result=operation.execute(client);
    if (result.isSuccess() || result.getCode() == ResultCode.SHARE_NOT_FOUND) {
      Log_OC.d(TAG,"Share id = " + share.getIdRemoteShared() + " deleted");
      OCFile file=getStorageManager().getFileByPath(mRemotePath);
      if (mShareType == ShareType.PUBLIC_LINK) {
        file.setShareViaLink(false);
        file.setPublicLink("");
      }
 else       if (mShareType == ShareType.USER || mShareType == ShareType.GROUP) {
        ArrayList<OCShare> sharesWith=getStorageManager().getSharesWithForAFile(mRemotePath,getStorageManager().getAccount().name);
        if (sharesWith.size() == 1) {
          file.setShareViaUsers(false);
        }
      }
      getStorageManager().saveFile(file);
      getStorageManager().removeShare(share);
      if (result.getCode() == ResultCode.SHARE_NOT_FOUND) {
        if (existsFile(client,file.getRemotePath())) {
          result=new RemoteOperationResult(ResultCode.OK);
        }
 else {
          getStorageManager().removeFile(file,true,true);
        }
      }
    }
  }
 else {
    result=new RemoteOperationResult(ResultCode.SHARE_NOT_FOUND);
  }
  return result;
}

{
  CreateShareRemoteOperation operation=new CreateShareRemoteOperation(mPath,mShareType,mShareWith,mPublicUpload,mPassword,mPermissions);
  RemoteOperationResult result=operation.execute(client);
  if (result.isSuccess()) {
    if (result.getData().size() > 0) {
      OCShare share=(OCShare)result.getData().get(0);
      if (mPath.endsWith(FileUtils.PATH_SEPARATOR)) {
        share.setPath(mPath.substring(0,mPath.length() - 1));
        share.setIsDirectory(true);
      }
 else {
        share.setPath(mPath);
        share.setIsDirectory(false);
      }
      share.setPermissions(mPermissions);
      getStorageManager().saveShare(share);
      OCFile file=getStorageManager().getFileByPath(mPath);
      if (file != null) {
        file.setPublicLink(share.getShareLink());
        getStorageManager().saveFile(file);
        Log_OC.d(TAG,"Public Link = " + file.getPublicLink());
      }
    }
  }
  return result;
}

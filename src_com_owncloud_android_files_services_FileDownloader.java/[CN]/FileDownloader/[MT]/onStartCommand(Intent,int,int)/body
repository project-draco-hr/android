{
  if (!intent.hasExtra(EXTRA_ACCOUNT) || !intent.hasExtra(EXTRA_FILE)) {
    Log_OC.e(TAG,"Not enough information provided in intent");
    return START_NOT_STICKY;
  }
 else {
    final Account account=intent.getParcelableExtra(EXTRA_ACCOUNT);
    final OCFile file=intent.getParcelableExtra(EXTRA_FILE);
    if (ACTION_CANCEL_FILE_DOWNLOAD.equals(intent.getAction())) {
      new Thread(new Runnable(){
        public void run(){
          cancel(account,file);
        }
      }
).start();
    }
 else {
      AbstractList<String> requestedDownloads=new Vector<String>();
      try {
        DownloadFileOperation newDownload=new DownloadFileOperation(account,file);
        String downloadKey=mPendingDownloads.putIfAbsent(account,file.getRemotePath(),newDownload);
        newDownload.addDatatransferProgressListener(this);
        newDownload.addDatatransferProgressListener((FileDownloaderBinder)mBinder);
        requestedDownloads.add(downloadKey);
        sendBroadcastNewDownload(newDownload);
      }
 catch (      IllegalArgumentException e) {
        Log_OC.e(TAG,"Not enough information provided in intent: " + e.getMessage());
        return START_NOT_STICKY;
      }
      if (requestedDownloads.size() > 0) {
        Message msg=mServiceHandler.obtainMessage();
        msg.arg1=startId;
        msg.obj=requestedDownloads;
        mServiceHandler.sendMessage(msg);
      }
    }
  }
  return START_NOT_STICKY;
}

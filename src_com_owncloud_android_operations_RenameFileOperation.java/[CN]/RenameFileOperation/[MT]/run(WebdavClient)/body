{
  RemoteOperationResult result=null;
  LocalMoveMethod move=null;
  mNewRemotePath=null;
  try {
    if (mNewName.equals(mFile.getFileName())) {
      return new RemoteOperationResult(ResultCode.OK);
    }
    String parent=(new File(mFile.getRemotePath())).getParent();
    parent=(parent.endsWith(OCFile.PATH_SEPARATOR)) ? parent : parent + OCFile.PATH_SEPARATOR;
    mNewRemotePath=parent + mNewName;
    if (mFile.isDirectory()) {
      mNewRemotePath+=OCFile.PATH_SEPARATOR;
    }
    if (!isValidNewName()) {
      return new RemoteOperationResult(ResultCode.INVALID_LOCAL_FILE_NAME);
    }
    if (client.existsFile(mNewRemotePath) || mStorageManager.getFileByPath(mNewRemotePath) != null) {
      return new RemoteOperationResult(ResultCode.INVALID_OVERWRITE);
    }
    move=new LocalMoveMethod(client.getBaseUri() + WebdavUtils.encodePath(mFile.getRemotePath()),client.getBaseUri() + WebdavUtils.encodePath(mNewRemotePath));
    int status=client.executeMethod(move,RENAME_READ_TIMEOUT,RENAME_CONNECTION_TIMEOUT);
    if (move.succeeded()) {
      if (mFile.isDirectory()) {
        saveLocalDirectory();
      }
 else {
        saveLocalFile();
      }
    }
    move.getResponseBodyAsString();
    result=new RemoteOperationResult(move.succeeded(),status);
    Log.i(TAG,"Rename " + mFile.getRemotePath() + " to "+ mNewRemotePath+ ": "+ result.getLogMessage());
  }
 catch (  Exception e) {
    result=new RemoteOperationResult(e);
    Log.e(TAG,"Rename " + mFile.getRemotePath() + " to "+ ((mNewRemotePath == null) ? mNewName : mNewRemotePath)+ ": "+ result.getLogMessage(),e);
  }
 finally {
    if (move != null)     move.releaseConnection();
  }
  return result;
}

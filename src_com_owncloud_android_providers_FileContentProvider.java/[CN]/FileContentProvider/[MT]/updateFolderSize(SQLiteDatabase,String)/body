{
  int count=0;
  String[] whereArgs=new String[]{folderId};
  long folderSize=0;
  long folderParentId=-1;
  Uri selectFolderUri=Uri.withAppendedPath(ProviderTableMeta.CONTENT_URI_FILE,folderId);
  String[] folderProjection=new String[]{ProviderTableMeta.FILE_CONTENT_LENGTH,ProviderTableMeta.FILE_PARENT};
  String folderWhere=ProviderTableMeta._ID + "=?";
  Cursor folderCursor=query(db,selectFolderUri,folderProjection,folderWhere,whereArgs,null);
  if (folderCursor != null && folderCursor.moveToFirst()) {
    folderSize=folderCursor.getLong(folderCursor.getColumnIndex(ProviderTableMeta.FILE_CONTENT_LENGTH));
    ;
    folderParentId=folderCursor.getLong(folderCursor.getColumnIndex(ProviderTableMeta.FILE_PARENT));
    ;
  }
  folderCursor.close();
  long childrenSize=0;
  Uri selectChildrenUri=Uri.withAppendedPath(ProviderTableMeta.CONTENT_URI_DIR,folderId);
  String[] childrenProjection=new String[]{ProviderTableMeta.FILE_CONTENT_LENGTH,ProviderTableMeta.FILE_PARENT};
  String childrenWhere=ProviderTableMeta.FILE_PARENT + "=?";
  Cursor childrenCursor=query(db,selectChildrenUri,childrenProjection,childrenWhere,whereArgs,null);
  if (childrenCursor != null && childrenCursor.moveToFirst()) {
    while (!childrenCursor.isAfterLast()) {
      childrenSize+=childrenCursor.getLong(childrenCursor.getColumnIndex(ProviderTableMeta.FILE_CONTENT_LENGTH));
      childrenCursor.moveToNext();
    }
  }
  childrenCursor.close();
  if (folderSize != childrenSize) {
    Log_OC.d("FileContentProvider","Updating " + folderSize + " to "+ childrenSize);
    ContentValues cv=new ContentValues();
    cv.put(ProviderTableMeta.FILE_CONTENT_LENGTH,childrenSize);
    count=db.update(ProviderTableMeta.DB_NAME,cv,folderWhere,whereArgs);
    if (folderParentId > FileDataStorageManager.ROOT_PARENT_ID) {
      Log_OC.d("FileContentProvider","Propagating update to " + folderParentId);
      updateFolderSize(db,String.valueOf(folderParentId));
    }
 else {
      Log_OC.d("FileContentProvider","NOT propagating to " + folderParentId);
    }
  }
 else {
    Log_OC.d("FileContentProvider","NOT updating, sizes are " + folderSize + " and "+ childrenSize);
  }
  return count;
}
